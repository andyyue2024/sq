D:\Workplace-Pycharm\.venv\Scripts\python.exe D:\Workplace-Pycharm\QuantitativeTransaction\SRC\sq\test\sq_test3_1.py
2024-08-31 11:23:22.223170: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-08-31 11:23:23.599095: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
----------------------------------------
python sdk version: 3.0.168
c sdk version: 3.7.4
----------------------------------------
[INFO]  Start...
[INFO]  ManualTrainer train...
[INFO]  Best model name: StackedEnsemble_BestOfFamily_1_AutoML_2_20240831_100856
Checking whether there is an H2O instance running at http://localhost:54321. connected.
--------------------------  -----------------------------
H2O_cluster_uptime:         12 hours 2 mins
H2O_cluster_timezone:       Asia/Shanghai
H2O_data_parsing_timezone:  UTC
H2O_cluster_version:        3.46.0.4
H2O_cluster_version_age:    1 month and 21 days
H2O_cluster_name:           H2O_from_python_Andy_obxxzc
H2O_cluster_total_nodes:    1
H2O_cluster_free_memory:    3.446 Gb
H2O_cluster_total_cores:    16
H2O_cluster_allowed_cores:  16
H2O_cluster_status:         locked, healthy
H2O_connection_url:         http://localhost:54321
H2O_connection_proxy:       {"http": null, "https": null}
H2O_internal_security:      False
Python_version:             3.12.3 final
--------------------------  -----------------------------
Parse progress: |████████████████████████████████████████████████████████████████| (done) 100%
response column levels:  [['0', '1']]
train shape: (1922, 24)
test shape: (1916, 24)
AutoML progress: |█
11:24:17.967: AutoML: XGBoost is not available; skipping it.

██████████████████████████████████████████████████████████████| (done) 100%
********************
leaderboard:  model_id                                                      auc    logloss     aucpr    mean_per_class_error      rmse        mse
StackedEnsemble_AllModels_1_AutoML_3_20240831_112417     0.941627   0.308231  0.943067                0.1327    0.308304  0.0950514
StackedEnsemble_BestOfFamily_1_AutoML_3_20240831_112417  0.94127    0.308989  0.942752                0.1345    0.308567  0.0952138
DRF_1_AutoML_3_20240831_112417                           0.932742   0.353028  0.932838                0.157599  0.329259  0.108412
XRT_1_AutoML_3_20240831_112417                           0.929627   0.365795  0.930391                0.147428  0.335293  0.112422
GBM_grid_1_AutoML_3_20240831_112417_model_1              0.923738   0.352212  0.925319                0.165635  0.331704  0.110028
GBM_4_AutoML_3_20240831_112417                           0.922291   0.355021  0.923164                0.155981  0.332585  0.110613
GBM_grid_1_AutoML_3_20240831_112417_model_5              0.921465   0.356739  0.923744                0.153338  0.334181  0.111677
GBM_5_AutoML_3_20240831_112417                           0.919357   0.366117  0.918706                0.163964  0.336717  0.113378
GBM_3_AutoML_3_20240831_112417                           0.909049   0.387814  0.910306                0.170048  0.347784  0.120953
GBM_2_AutoML_3_20240831_112417                           0.908607   0.394546  0.907575                0.175343  0.350711  0.122998
[22 rows x 7 columns]

********************
leaderboard.head:  model_id                                                      auc    logloss     aucpr    mean_per_class_error      rmse        mse
StackedEnsemble_AllModels_1_AutoML_3_20240831_112417     0.941627   0.308231  0.943067                0.1327    0.308304  0.0950514
StackedEnsemble_BestOfFamily_1_AutoML_3_20240831_112417  0.94127    0.308989  0.942752                0.1345    0.308567  0.0952138
DRF_1_AutoML_3_20240831_112417                           0.932742   0.353028  0.932838                0.157599  0.329259  0.108412
XRT_1_AutoML_3_20240831_112417                           0.929627   0.365795  0.930391                0.147428  0.335293  0.112422
GBM_grid_1_AutoML_3_20240831_112417_model_1              0.923738   0.352212  0.925319                0.165635  0.331704  0.110028
[5 rows x 7 columns]

********************
Best Model: Model Details
=============
H2OStackedEnsembleEstimator : Stacked Ensemble
Model Key: StackedEnsemble_AllModels_1_AutoML_3_20240831_112417


Model Summary for Stacked Ensemble:
key                                        value
-----------------------------------------  ----------------
Stacking strategy                          cross_validation
Number of base models (used / total)       7/20
# GBM base models (used / total)           1/10
# DRF base models (used / total)           2/2
# GLM base models (used / total)           1/1
# DeepLearning base models (used / total)  3/7
Metalearner algorithm                      GLM
Metalearner fold assignment scheme         Random
Metalearner nfolds                         5
Metalearner fold_column
Custom metalearner hyperparameters         None

ModelMetricsBinomialGLM: stackedensemble
** Reported on train data. **

MSE: 0.01458610622096051
RMSE: 0.12077295318472804
LogLoss: 0.07791456248865745
AUC: 0.9997623100646257
AUCPR: 0.9997715819167374
Gini: 0.9995246201292514
Null degrees of freedom: 1921
Residual degrees of freedom: 1914
Null deviance: 2664.3557840634317
Residual deviance: 299.50357820639925
AIC: 315.50357820639925

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.5393987711529153
       0    1    Error    Rate
-----  ---  ---  -------  -------------
0      951  3    0.0031   (3.0/954.0)
1      11   957  0.0114   (11.0/968.0)
Total  962  960  0.0073   (14.0/1922.0)

Maximum Metrics: Maximum metrics at their respective thresholds
metric                       threshold    value     idx
---------------------------  -----------  --------  -----
max f1                       0.539399     0.992739  201
max f2                       0.402926     0.993821  219
max f0point5                 0.581542     0.996862  195
max accuracy                 0.558688     0.992716  198
max precision                1            1         0
max recall                   0.241142     1         247
max specificity              1            1         0
max absolute_mcc             0.558688     0.985509  198
max min_per_class_accuracy   0.496198     0.990566  207
max mean_per_class_accuracy  0.558688     0.992761  198
max tns                      1            954       0
max fns                      1            889       0
max fps                      4.59201e-06  954       399
max tps                      0.241142     968       247
max tnr                      1            1         0
max fnr                      1            0.918388  0
max fpr                      4.59201e-06  1         399
max tpr                      0.241142     1         247

Gains/Lift Table: Avg response rate: 50.36 %, avg score: 49.85 %
group    cumulative_data_fraction    lower_threshold    lift      cumulative_lift    response_rate    score        cumulative_response_rate    cumulative_score    capture_rate    cumulative_capture_rate    gain      cumulative_gain    kolmogorov_smirnov
-------  --------------------------  -----------------  --------  -----------------  ---------------  -----------  --------------------------  ------------------  --------------  -------------------------  --------  -----------------  --------------------
1        0.0104058                   1                  1.98554   1.98554            1                1            1                           1                   0.0206612       0.0206612                  98.5537   98.5537            0.0206612
2        0.0202914                   1                  1.98554   1.98554            1                1            1                           1                   0.0196281       0.0402893                  98.5537   98.5537            0.0402893
3        0.0301769                   1                  1.98554   1.98554            1                1            1                           1                   0.0196281       0.0599174                  98.5537   98.5537            0.0599174
4        0.0400624                   0.999999           1.98554   1.98554            1                1            1                           1                   0.0196281       0.0795455                  98.5537   98.5537            0.0795455
5        0.0504683                   0.999383           1.98554   1.98554            1                0.999641     1                           0.999926            0.0206612       0.100207                   98.5537   98.5537            0.100207
6        0.100416                    0.993821           1.98554   1.98554            1                0.996871     1                           0.998407            0.0991736       0.19938                    98.5537   98.5537            0.19938
7        0.150364                    0.987468           1.98554   1.98554            1                0.990525     1                           0.995788            0.0991736       0.298554                   98.5537   98.5537            0.298554
8        0.200312                    0.980893           1.98554   1.98554            1                0.984579     1                           0.992993            0.0991736       0.397727                   98.5537   98.5537            0.397727
9        0.300208                    0.955309           1.98554   1.98554            1                0.969586     1                           0.985204            0.198347        0.596074                   98.5537   98.5537            0.596074
10       0.400104                    0.884683           1.98554   1.98554            1                0.927496     1                           0.970796            0.198347        0.794421                   98.5537   98.5537            0.794421
11       0.5                         0.528589           1.94417   1.97727            0.979167         0.774929     0.995838                    0.931663            0.194215        0.988636                   94.4172   97.7273            0.984443
12       0.599896                    0.104391           0.113755  1.66696            0.0572917        0.222537     0.839549                    0.813578            0.0113636       1                          -88.6245  66.6956            0.80608
13       0.699792                    0.0417244          0         1.429              0                0.0669613    0.719703                    0.706998            0               1                          -100      42.8996            0.604822
14       0.799688                    0.016194           0         1.25049            0                0.0279211    0.629798                    0.622169            0               1                          -100      25.0488            0.403564
15       0.899584                    0.00379302         0         1.11163            0                0.00910193   0.559861                    0.554089            0               1                          -100      11.1625            0.202306
16       1                           1.82175e-14        0         1                  0                0.000875286  0.503642                    0.498538            0               1                          -100      0                  0

ModelMetricsBinomialGLM: stackedensemble
** Reported on cross-validation data. **

MSE: 0.0950514274477797
RMSE: 0.3083041151976076
LogLoss: 0.3082312424810942
AUC: 0.9416268170556336
AUCPR: 0.9430671575082124
Gini: 0.8832536341112671
Null degrees of freedom: 1921
Residual degrees of freedom: 1914
Null deviance: 2667.4837890457775
Residual deviance: 1184.840896097326
AIC: 1200.840896097326

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.49770648246475696
       0    1    Error    Rate
-----  ---  ---  -------  --------------
0      824  130  0.1363   (130.0/954.0)
1      125  843  0.1291   (125.0/968.0)
Total  949  973  0.1327   (255.0/1922.0)

Maximum Metrics: Maximum metrics at their respective thresholds
metric                       threshold    value     idx
---------------------------  -----------  --------  -----
max f1                       0.497706     0.868624  208
max f2                       0.173235     0.913171  305
max f0point5                 0.68266      0.893024  150
max accuracy                 0.604592     0.868887  176
max precision                0.999972     1         0
max recall                   0.0118484    1         388
max specificity              0.999972     1         0
max absolute_mcc             0.604592     0.739862  176
max min_per_class_accuracy   0.505996     0.866736  205
max mean_per_class_accuracy  0.604592     0.869145  176
max tns                      0.999972     954       0
max fns                      0.999972     908       0
max fps                      3.20369e-05  954       399
max tps                      0.0118484    968       388
max tnr                      0.999972     1         0
max fnr                      0.999972     0.938017  0
max fpr                      3.20369e-05  1         399
max tpr                      0.0118484    1         388

Gains/Lift Table: Avg response rate: 50.36 %, avg score: 50.37 %
group    cumulative_data_fraction    lower_threshold    lift       cumulative_lift    response_rate    score       cumulative_response_rate    cumulative_score    capture_rate    cumulative_capture_rate    gain      cumulative_gain    kolmogorov_smirnov
-------  --------------------------  -----------------  ---------  -----------------  ---------------  ----------  --------------------------  ------------------  --------------  -------------------------  --------  -----------------  --------------------
1        0.012487                    1                  1.98554    1.98554            1                1           1                           1                   0.0247934       0.0247934                  98.5537   98.5537            0.0247934
2        0.0202914                   1                  1.98554    1.98554            1                1           1                           1                   0.0154959       0.0402893                  98.5537   98.5537            0.0402893
3        0.0301769                   0.999758           1.98554    1.98554            1                0.999986    1                           0.999995            0.0196281       0.0599174                  98.5537   98.5537            0.0599174
4        0.0400624                   0.997632           1.98554    1.98554            1                0.998701    1                           0.999676            0.0196281       0.0795455                  98.5537   98.5537            0.0795455
5        0.0504683                   0.995033           1.98554    1.98554            1                0.996252    1                           0.99897             0.0206612       0.100207                   98.5537   98.5537            0.100207
6        0.100416                    0.985629           1.98554    1.98554            1                0.990783    1                           0.994898            0.0991736       0.19938                    98.5537   98.5537            0.19938
7        0.150364                    0.97244            1.90281    1.95806            0.958333         0.979026    0.986159                    0.989625            0.0950413       0.294421                   90.2806   95.8056            0.290229
8        0.200312                    0.951606           1.90281    1.94428            0.958333         0.963094    0.979221                    0.98301             0.0950413       0.389463                   90.2806   94.4279            0.381077
9        0.300208                    0.891893           1.8511     1.91327            0.932292         0.926181    0.963605                    0.9641              0.184917        0.57438                    85.11     91.3273            0.552368
10       0.400104                    0.739164           1.69598    1.85902            0.854167         0.825259    0.936281                    0.929434            0.169421        0.743802                   69.598    85.9021            0.692439
11       0.5                         0.508886           1.20994    1.72934            0.609375         0.635584    0.870968                    0.870726            0.120868        0.864669                   20.9937   72.9339            0.73469
12       0.599896                    0.273956           0.7756     1.57052            0.390625         0.384257    0.79098                     0.789718            0.0774793       0.942149                   -22.44    57.052             0.689528
13       0.699792                    0.115285           0.351606   1.39652            0.177083         0.185786    0.703346                    0.703506            0.035124        0.977273                   -64.8394  39.6519            0.559034
14       0.799688                    0.0511778          0.144779   1.24015            0.0729167        0.0782661   0.624593                    0.625402            0.0144628       0.991736                   -85.5221  24.0153            0.386914
15       0.899584                    0.013358           0.0723894  1.11048            0.0364583        0.0311726   0.559283                    0.559415            0.0072314       0.998967                   -92.7611  11.0477            0.200225
16       1                           0                  0.0102878  1                  0.00518135       0.00467164  0.503642                    0.503709            0.00103306      1                          -98.9712  0                  0

Cross-Validation Metrics Summary:
                      mean        sd           cv_1_valid    cv_2_valid    cv_3_valid    cv_4_valid    cv_5_valid
--------------------  ----------  -----------  ------------  ------------  ------------  ------------  ------------
accuracy              0.87252223  0.01105365   0.8762626     0.88918203    0.8670077     0.85978836    0.8703704
aic                   252.56105   19.075695    239.18231     228.13602     254.51314     274.5779      266.3959
auc                   0.94267356  0.010081663  0.9513541     0.9541474     0.94107795    0.9298728     0.9369156
err                   0.12747778  0.01105365   0.12373737    0.11081794    0.13299233    0.14021164    0.12962963
err_count             49.0        4.3011627    49.0          42.0          52.0          53.0          49.0
f0point5              0.86118966  0.021896414  0.85828346    0.893401      0.84176636    0.8413206     0.871177
f1                    0.8770783   0.013773105  0.87531805    0.893401      0.8755981     0.85636854    0.8847059
f2                    0.8938666   0.014508763  0.89304256    0.893401      0.9122632     0.8719647     0.89866155
lift_top_group        1.990203    0.11743636   2.0842106     1.9238579     2.0051281     2.1117318     1.826087
loglikelihood         0.0         0.0          0.0           0.0           0.0           0.0           0.0
---                   ---         ---          ---           ---           ---           ---           ---
mean_per_class_error  0.12781745  0.011125931  0.12261114    0.1109918     0.13281004    0.13906123    0.13361302
mse                   0.0949783   0.008438724  0.0880414     0.0854669     0.09472123    0.10515586    0.10150611
null_deviance         533.49677   11.665962    549.7548      525.4252      542.0982      525.08356     525.122
pr_auc                0.94413996  0.013267214  0.95012087    0.95819527    0.93444693    0.9262541     0.9516828
precision             0.85105675  0.028464288  0.84729064    0.893401      0.8206278     0.83157897    0.86238533
r2                    0.6188844   0.03458187   0.6472585     0.65759605    0.6211126     0.57819575    0.59025913
recall                0.90560395  0.020981478  0.9052632     0.893401      0.93846154    0.88268155    0.90821254
residual_deviance     236.56105   18.734484    225.18231     210.13602     242.51314     256.5779      248.3959
rmse                  0.30794215  0.013689924  0.2967177     0.29234722    0.30776814    0.32427743    0.31860024
specificity           0.83876115  0.032617375  0.84951454    0.88461536    0.79591835    0.83919597    0.8245614
[24 rows x 8 columns]

stackedensemble prediction progress: |███████████████████████████████████████████| (done) 100%
********************
predictions.head:    predict           p0           p1
        0  1            1.05429e-12
        0  1            4.25696e-13
        0  0.986888     0.0131121
        0  0.958847     0.0411532
        0  0.932016     0.0679836
        1  0.0790384    0.920962
        1  0.034612     0.965388
        1  7.89742e-09  1
        1  9.79461e-09  1
        1  0.00371109   0.996289
[10 rows x 3 columns]

********************
metrics: ModelMetricsBinomialGLM: stackedensemble
** Reported on test data. **

MSE: 0.0973634745698256
RMSE: 0.3120312076857467
LogLoss: 0.3258382729401946
AUC: 0.9355320256328044
AUCPR: 0.9154476067196313
Gini: 0.8710640512656087
Null degrees of freedom: 1915
Residual degrees of freedom: 1908
Null deviance: 2658.6891512221564
Residual deviance: 1248.6122619068253
AIC: 1264.6122619068253

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.4065605886128776
       0    1    Error    Rate
-----  ---  ---  -------  --------------
0      866  176  0.1689   (176.0/1042.0)
1      82   792  0.0938   (82.0/874.0)
Total  948  968  0.1347   (258.0/1916.0)

Maximum Metrics: Maximum metrics at their respective thresholds
metric                       threshold    value     idx
---------------------------  -----------  --------  -----
max f1                       0.406561     0.859935  225
max f2                       0.240954     0.909486  275
max f0point5                 0.670931     0.869176  147
max accuracy                 0.506627     0.867954  199
max precision                0.999961     1         0
max recall                   0.00227267   1         397
max specificity              0.999961     1         0
max absolute_mcc             0.481236     0.73511   206
max min_per_class_accuracy   0.503929     0.867277  200
max mean_per_class_accuracy  0.406561     0.868636  225
max tns                      0.999961     1042      0
max fns                      0.999961     844       0
max fps                      9.01455e-05  1042      399
max tps                      0.00227267   874       397
max tnr                      0.999961     1         0
max fnr                      0.999961     0.965675  0
max fpr                      9.01455e-05  1         399
max tpr                      0.00227267   1         397

Gains/Lift Table: Avg response rate: 45.62 %, avg score: 46.71 %
group    cumulative_data_fraction    lower_threshold    lift       cumulative_lift    response_rate    score       cumulative_response_rate    cumulative_score    capture_rate    cumulative_capture_rate    gain      cumulative_gain    kolmogorov_smirnov
-------  --------------------------  -----------------  ---------  -----------------  ---------------  ----------  --------------------------  ------------------  --------------  -------------------------  --------  -----------------  --------------------
1        0.0104384                   1                  2.19222    2.19222            1                1           1                           1                   0.0228833       0.0228833                  119.222   119.222            0.0228833
2        0.0203549                   0.997766           2.19222    2.19222            1                0.999204    1                           0.999612            0.0217391       0.0446224                  119.222   119.222            0.0446224
3        0.0302714                   0.995562           2.19222    2.19222            1                0.99664     1                           0.998639            0.0217391       0.0663616                  119.222   119.222            0.0663616
4        0.0401879                   0.99329            2.19222    2.19222            1                0.994382    1                           0.997588            0.0217391       0.0881007                  119.222   119.222            0.0881007
5        0.0501044                   0.991441           2.07684    2.16938            0.947368         0.992343    0.989583                    0.99655             0.020595        0.108696                   107.684   116.938            0.107736
6        0.100209                    0.979119           2.00953    2.08946            0.916667         0.985727    0.953125                    0.991138            0.100686        0.209382                   100.953   108.946            0.200745
7        0.150313                    0.956764           2.00953    2.06282            0.916667         0.968347    0.940972                    0.983541            0.100686        0.310069                   100.953   106.282            0.293754
8        0.200418                    0.931114           2.05521    2.06091            0.9375           0.944503    0.940104                    0.973782            0.102975        0.413043                   105.521   106.091            0.390971
9        0.300104                    0.830548           1.97415    2.03209            0.900524         0.88905     0.926957                    0.945636            0.196796        0.60984                    97.4145   103.209            0.569533
10       0.400313                    0.660742           1.71267    1.95213            0.78125          0.751356    0.890482                    0.897003            0.171625        0.781465                   71.2672   95.2133            0.70085
11       0.5                         0.416663           1.18219    1.79863            0.539267         0.539368    0.820459                    0.8257              0.117849        0.899314                   18.2192   79.8627            0.734246
12       0.600209                    0.206286           0.639397   1.60509            0.291667         0.307472    0.732174                    0.739178            0.0640732       0.963387                   -36.0603  60.5086            0.667801
13       0.699896                    0.0913645          0.229552   1.40917            0.104712         0.141039    0.642804                    0.653985            0.0228833       0.98627                    -77.0448  40.9167            0.526577
14       0.800104                    0.0424829          0.0570891  1.23983            0.0260417        0.0653739   0.565558                    0.580264            0.00572082      0.991991                   -94.2911  23.9827            0.352835
15       0.899791                    0.0117009          0.0344328  1.10628            0.0157068        0.0246422   0.50464                     0.518708            0.00343249      0.995423                   -96.5567  10.6283            0.175846
16       1                           4.25696e-13        0.0456712  1                  0.0208333        0.00355373  0.456159                    0.467085            0.00457666      1                          -95.4329  0                  0
[INFO]  getting best model finished!, time elapsed: 614.0460500717163 seconds