D:\Workplace-Pycharm\.venv\Scripts\python.exe D:\Workplace-Pycharm\QuantitativeTransaction\SRC\sq\test\sq_test3_1.py
2024-08-31 10:07:19.095907: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-08-31 10:07:24.684779: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
----------------------------------------
python sdk version: 3.0.168
c sdk version: 3.7.4
----------------------------------------
[INFO]  Start...
[INFO]  ManualTrainer train...
[INFO]  Best model name: StackedEnsemble_AllModels_1_AutoML_1_20240830_230008
Checking whether there is an H2O instance running at http://localhost:54321. connected.
--------------------------  -----------------------------
H2O_cluster_uptime:         10 hours 46 mins
H2O_cluster_timezone:       Asia/Shanghai
H2O_data_parsing_timezone:  UTC
H2O_cluster_version:        3.46.0.4
H2O_cluster_version_age:    1 month and 21 days
H2O_cluster_name:           H2O_from_python_Andy_obxxzc
H2O_cluster_total_nodes:    1
H2O_cluster_free_memory:    3.749 Gb
H2O_cluster_total_cores:    16
H2O_cluster_allowed_cores:  16
H2O_cluster_status:         locked, healthy
H2O_connection_url:         http://localhost:54321
H2O_connection_proxy:       {"http": null, "https": null}
H2O_internal_security:      False
Python_version:             3.12.3 final
--------------------------  -----------------------------
Parse progress: |████████████████████████████████████████████████████████████████| (done) 100%
response column levels:  [['0', '1']]
train shape: (3785, 24)
test shape: (53, 24)
AutoML progress: |██
10:08:56.464: AutoML: XGBoost is not available; skipping it.

█████████████████████████████████████████████████████████████| (done) 100%
********************
leaderboard:  model_id                                                      auc    logloss     aucpr    mean_per_class_error      rmse        mse
StackedEnsemble_BestOfFamily_1_AutoML_2_20240831_100856  0.979502   0.176629  0.979168               0.0958749  0.243699  0.059389
StackedEnsemble_AllModels_1_AutoML_2_20240831_100856     0.979372   0.177359  0.97901                0.0956407  0.244181  0.0596244
GBM_grid_1_AutoML_2_20240831_100856_model_1              0.978695   0.184213  0.978257               0.0984174  0.246978  0.0609982
GBM_grid_1_AutoML_2_20240831_100856_model_5              0.976278   0.199871  0.975259               0.0994219  0.254195  0.0646151
DRF_1_AutoML_2_20240831_100856                           0.975762   0.25026   0.975248               0.100453   0.268087  0.0718708
GBM_4_AutoML_2_20240831_100856                           0.974904   0.208326  0.973939               0.10126    0.25756   0.0663371
XRT_1_AutoML_2_20240831_100856                           0.97405    0.261491  0.973946               0.106128   0.274174  0.0751716
GBM_3_AutoML_2_20240831_100856                           0.973732   0.215562  0.972816               0.0966998  0.257745  0.0664326
GBM_5_AutoML_2_20240831_100856                           0.970295   0.235079  0.968177               0.108866   0.266808  0.0711863
GBM_grid_1_AutoML_2_20240831_100856_model_4              0.969857   0.230188  0.968742               0.104284   0.266303  0.0709173
[22 rows x 7 columns]

********************
leaderboard.head:  model_id                                                      auc    logloss     aucpr    mean_per_class_error      rmse        mse
StackedEnsemble_BestOfFamily_1_AutoML_2_20240831_100856  0.979502   0.176629  0.979168               0.0958749  0.243699  0.059389
StackedEnsemble_AllModels_1_AutoML_2_20240831_100856     0.979372   0.177359  0.97901                0.0956407  0.244181  0.0596244
GBM_grid_1_AutoML_2_20240831_100856_model_1              0.978695   0.184213  0.978257               0.0984174  0.246978  0.0609982
GBM_grid_1_AutoML_2_20240831_100856_model_5              0.976278   0.199871  0.975259               0.0994219  0.254195  0.0646151
DRF_1_AutoML_2_20240831_100856                           0.975762   0.25026   0.975248               0.100453   0.268087  0.0718708
[5 rows x 7 columns]

********************
Best Model: Model Details
=============
H2OStackedEnsembleEstimator : Stacked Ensemble
Model Key: StackedEnsemble_BestOfFamily_1_AutoML_2_20240831_100856


Model Summary for Stacked Ensemble:
key                                        value
-----------------------------------------  ----------------
Stacking strategy                          cross_validation
Number of base models (used / total)       4/5
# GBM base models (used / total)           1/1
# DRF base models (used / total)           2/2
# GLM base models (used / total)           1/1
# DeepLearning base models (used / total)  0/1
Metalearner algorithm                      GLM
Metalearner fold assignment scheme         Random
Metalearner nfolds                         5
Metalearner fold_column
Custom metalearner hyperparameters         None

ModelMetricsBinomialGLM: stackedensemble
** Reported on train data. **

MSE: 0.0017181470012481292
RMSE: 0.04145053680289471
LogLoss: 0.02065152817545722
AUC: 1.0
AUCPR: 1.0
Gini: 1.0
Null degrees of freedom: 3784
Residual degrees of freedom: 3780
Null deviance: 5241.567975677109
Residual deviance: 156.3320682882111
AIC: 166.3320682882111

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.7177730873871014
       0     1     Error    Rate
-----  ----  ----  -------  ------------
0      1965  0     0        (0.0/1965.0)
1      0     1820  0        (0.0/1820.0)
Total  1965  1820  0        (0.0/3785.0)

Maximum Metrics: Maximum metrics at their respective thresholds
metric                       threshold    value     idx
---------------------------  -----------  --------  -----
max f1                       0.717773     1         195
max f2                       0.717773     1         195
max f0point5                 0.717773     1         195
max accuracy                 0.717773     1         195
max precision                0.999991     1         0
max recall                   0.717773     1         195
max specificity              0.999991     1         0
max absolute_mcc             0.717773     1         195
max min_per_class_accuracy   0.717773     1         195
max mean_per_class_accuracy  0.717773     1         195
max tns                      0.999991     1965      0
max fns                      0.999991     1556      0
max fps                      9.10829e-06  1965      399
max tps                      0.717773     1820      195
max tnr                      0.999991     1         0
max fnr                      0.999991     0.854945  0
max fpr                      9.10829e-06  1         399
max tpr                      0.717773     1         195

Gains/Lift Table: Avg response rate: 48.08 %, avg score: 48.17 %
group    cumulative_data_fraction    lower_threshold    lift     cumulative_lift    response_rate    score        cumulative_response_rate    cumulative_score    capture_rate    cumulative_capture_rate    gain     cumulative_gain    kolmogorov_smirnov
-------  --------------------------  -----------------  -------  -----------------  ---------------  -----------  --------------------------  ------------------  --------------  -------------------------  -------  -----------------  --------------------
1        0.0100396                   1                  2.07967  2.07967            1                1            1                           1                   0.0208791       0.0208791                  107.967  107.967            0.0208791
2        0.0200793                   1                  2.07967  2.07967            1                1            1                           1                   0.0208791       0.0417582                  107.967  107.967            0.0417582
3        0.0301189                   1                  2.07967  2.07967            1                1            1                           1                   0.0208791       0.0626374                  107.967  107.967            0.0626374
4        0.0401585                   1                  2.07967  2.07967            1                1            1                           1                   0.0208791       0.0835165                  107.967  107.967            0.0835165
5        0.0501982                   1                  2.07967  2.07967            1                1            1                           1                   0.0208791       0.104396                   107.967  107.967            0.104396
6        0.100132                    0.999406           2.07967  2.07967            1                0.999745     1                           0.999873            0.103846        0.208242                   107.967  107.967            0.208242
7        0.150066                    0.998478           2.07967  2.07967            1                0.998988     1                           0.999579            0.103846        0.312088                   107.967  107.967            0.312088
8        0.2                         0.997069           2.07967  2.07967            1                0.99779      1                           0.999132            0.103846        0.415934                   107.967  107.967            0.415934
9        0.300132                    0.991649           2.07967  2.07967            1                0.994712     1                           0.997657            0.208242        0.624176                   107.967  107.967            0.624176
10       0.4                         0.961926           2.07967  2.07967            1                0.981296     1                           0.993572            0.207692        0.831868                   107.967  107.967            0.831868
11       0.500132                    0.117264           1.6791   1.99947            0.807388         0.770762     0.961437                    0.948963            0.168132        1                          67.9101  99.9472            0.96285
12       0.6                         0.0208322          0        1.66667            0                0.0563563    0.801409                    0.800392            0               1                          -100     66.6667            0.770483
13       0.699868                    0.00539425         0        1.42884            0                0.0109706    0.687052                    0.687745            0               1                          -100     42.8841            0.578117
14       0.8                         0.00174947         0        1.25               0                0.00319923   0.601057                    0.602064            0               1                          -100     25                 0.385242
15       0.899868                    0.000156582        0        1.11127            0                0.000902214  0.534351                    0.535347            0               1                          -100     11.1274            0.192875
16       1                           4.75339e-12        0        1                  0                2.29156e-05  0.480845                    0.481743            0               1                          -100     0                  0

ModelMetricsBinomialGLM: stackedensemble
** Reported on cross-validation data. **

MSE: 0.059388993554163765
RMSE: 0.24369857109585966
LogLoss: 0.17662920345686076
AUC: 0.9795018594636915
AUCPR: 0.979167706890284
Gini: 0.959003718927383
Null degrees of freedom: 3784
Residual degrees of freedom: 3780
Null deviance: 5245.979030472167
Residual deviance: 1337.0830701684358
AIC: 1347.0830701684358

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.21626973550546202
       0     1     Error    Rate
-----  ----  ----  -------  --------------
0      1626  339   0.1725   (339.0/1965.0)
1      35    1785  0.0192   (35.0/1820.0)
Total  1661  2124  0.0988   (374.0/3785.0)

Maximum Metrics: Maximum metrics at their respective thresholds
metric                       threshold    value     idx
---------------------------  -----------  --------  -----
max f1                       0.21627      0.905172  291
max f2                       0.13027      0.952381  317
max f0point5                 0.836704     0.94155   95
max accuracy                 0.727515     0.905945  125
max precision                0.999985     1         0
max recall                   0.0312122    1         360
max specificity              0.999985     1         0
max absolute_mcc             0.727515     0.818027  125
max min_per_class_accuracy   0.482746     0.902198  204
max mean_per_class_accuracy  0.21627      0.904125  291
max tns                      0.999985     1965      0
max fns                      0.999985     1676      0
max fps                      3.57758e-05  1965      399
max tps                      0.0312122    1820      360
max tnr                      0.999985     1         0
max fnr                      0.999985     0.920879  0
max fpr                      3.57758e-05  1         399
max tpr                      0.0312122    1         360

Gains/Lift Table: Avg response rate: 48.08 %, avg score: 48.09 %
group    cumulative_data_fraction    lower_threshold    lift       cumulative_lift    response_rate    score        cumulative_response_rate    cumulative_score    capture_rate    cumulative_capture_rate    gain      cumulative_gain    kolmogorov_smirnov
-------  --------------------------  -----------------  ---------  -----------------  ---------------  -----------  --------------------------  ------------------  --------------  -------------------------  --------  -----------------  --------------------
1        0.0153236                   1                  2.07967    2.07967            1                1            1                           1                   0.0318681       0.0318681                  107.967   107.967            0.0318681
2        0.0200793                   1                  2.07967    2.07967            1                1            1                           1                   0.00989011      0.0417582                  107.967   107.967            0.0417582
3        0.0301189                   0.999997           2.07967    2.07967            1                0.999999     1                           1                   0.0208791       0.0626374                  107.967   107.967            0.0626374
4        0.0401585                   0.999812           2.07967    2.07967            1                0.99992      1                           0.99998             0.0208791       0.0835165                  107.967   107.967            0.0835165
5        0.0501982                   0.99962            2.07967    2.07967            1                0.999711     1                           0.999926            0.0208791       0.104396                   107.967   107.967            0.104396
6        0.100132                    0.998345           2.07967    2.07967            1                0.999001     1                           0.999465            0.103846        0.208242                   107.967   107.967            0.208242
7        0.150066                    0.996166           2.07967    2.07967            1                0.99732      1                           0.998751            0.103846        0.312088                   107.967   107.967            0.312088
8        0.2                         0.992972           2.07967    2.07967            1                0.994636     1                           0.997724            0.103846        0.415934                   107.967   107.967            0.415934
9        0.300132                    0.973967           2.07967    2.07967            1                0.985664     1                           0.9937              0.208242        0.624176                   107.967   107.967            0.624176
10       0.4                         0.794154           1.89811    2.03434            0.912698         0.92132      0.978203                    0.975629            0.18956         0.813736                   89.8112   103.434            0.796942
11       0.500132                    0.435918           1.00966    1.82919            0.485488         0.598955     0.879556                    0.900215            0.101099        0.914835                   0.965525  82.9187            0.798805
12       0.6                         0.0797418          0.825266   1.66209            0.396825         0.259662     0.799207                    0.793597            0.0824176       0.997253                   -17.4734  66.2088            0.765192
13       0.699868                    0.0148515          0.0275089  1.42884            0.0132275        0.036644     0.687052                    0.685583            0.00274725      1                          -97.2491  42.8841            0.578117
14       0.8                         0.00452833         0          1.25               0                0.00845395   0.601057                    0.60083             0               1                          -100      25                 0.385242
15       0.899868                    0.000909342        0          1.11127            0                0.00244525   0.534351                    0.534421            0               1                          -100      11.1274            0.192875
16       1                           0                  0          1                  0                0.000227485  0.480845                    0.480931            0               1                          -100      0                  0

Cross-Validation Metrics Summary:
                      mean        sd            cv_1_valid    cv_2_valid    cv_3_valid    cv_4_valid    cv_5_valid
--------------------  ----------  ------------  ------------  ------------  ------------  ------------  ------------
accuracy              0.90851164  0.0055889855  0.90789473    0.90589714    0.9156785     0.911958      0.90112996
aic                   277.13474   30.974108     298.93066     320.4503      249.23476     261.3152      255.74283
auc                   0.979838    0.0030928752  0.9764216     0.97729534    0.98376465    0.98200375    0.9797047
err                   0.09148835  0.0055889855  0.09210526    0.09410289    0.08432148    0.08804205    0.098870054
err_count             69.2        4.086563      70.0          75.0          64.0          67.0          70.0
f0point5              0.88520944  0.026209524   0.9292035     0.88053095    0.877193      0.8804297     0.85869
f1                    0.9089542   0.009879756   0.89361703    0.9138921     0.9139785     0.9183922     0.9048913
f2                    0.93612874  0.042344056   0.8606557     0.94988066    0.95398426    0.959776      0.9563469
lift_top_group        2.085862    0.106143765   2.1714287     1.9534314     2.1936417     1.9973754     2.113433
loglikelihood         0.0         0.0           0.0           0.0           0.0           0.0           0.0
---                   ---         ---           ---           ---           ---           ---           ---
mean_per_class_error  0.09080921  0.0074909544  0.09707317    0.095802456   0.07888844    0.08814408    0.09413789
mse                   0.05908989  0.0057700337  0.06403584    0.06558437    0.05205182    0.05497721    0.058800213
null_deviance         1049.1958   46.12561      1050.8113     1109.369      1049.2471     1056.8427     979.70917
pr_auc                0.97940636  0.003271822   0.97440934    0.97919637    0.98190403    0.9827481     0.9787741
precision             0.87113404  0.048054256   0.95454544    0.8596112     0.85427135    0.8568182     0.83042395
r2                    0.7628263   0.022972025   0.74225014    0.73751336    0.79015756    0.7800908     0.7641196
recall                0.9563361   0.06541141    0.84          0.9754902     0.982659      0.9895013     0.9940299
residual_deviance     267.13474   30.974108     288.93066     310.4503      239.23476     251.31519     245.74283
rmse                  0.24285118  0.011895013   0.25305304    0.25609446    0.22814868    0.23447219    0.24248755
specificity           0.8620455   0.059944298   0.96585363    0.8329049     0.8595642     0.8342105     0.81769437
[24 rows x 8 columns]

stackedensemble prediction progress: |███████████████████████████████████████████| (done) 100%
********************
predictions.head:    predict          p0           p1
        1  0.467683    0.532317
        1  0.00621371  0.993786
        0  0.897022    0.102978
        1  0.00391919  0.996081
        0  0.999953    4.69231e-05
        0  0.998811    0.00118859
        1  0.644504    0.355496
        0  0.818794    0.181206
        1  0.00534623  0.994654
        0  0.999635    0.000364997
[10 rows x 3 columns]

********************
metrics: ModelMetricsBinomialGLM: stackedensemble
** Reported on test data. **

MSE: 0.06173730221870348
RMSE: 0.2484699221610203
LogLoss: 0.18040077323948614
AUC: 0.9765395894428153
AUCPR: 0.9691812657243458
Gini: 0.9530791788856305
Null degrees of freedom: 52
Residual degrees of freedom: 48
Null deviance: 72.86153875245877
Residual deviance: 19.12248196338553
AIC: 29.12248196338553

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.5608093854865241
       0    1    Error    Rate
-----  ---  ---  -------  ----------
0      29   2    0.0645   (2.0/31.0)
1      2    20   0.0909   (2.0/22.0)
Total  31   22   0.0755   (4.0/53.0)

Maximum Metrics: Maximum metrics at their respective thresholds
metric                       threshold    value     idx
---------------------------  -----------  --------  -----
max f1                       0.560809     0.909091  21
max f2                       0.181206     0.956522  26
max f0point5                 0.693462     0.944444  16
max accuracy                 0.560809     0.924528  21
max precision                0.99968      1         0
max recall                   0.181206     1         26
max specificity              0.99968      1         0
max absolute_mcc             0.560809     0.844575  21
max min_per_class_accuracy   0.560809     0.909091  21
max mean_per_class_accuracy  0.560809     0.922287  21
max tns                      0.99968      31        0
max fns                      0.99968      21        0
max fps                      2.78953e-09  31        52
max tps                      0.181206     22        26
max tnr                      0.99968      1         0
max fnr                      0.99968      0.954545  0
max fpr                      2.78953e-09  1         52
max tpr                      0.181206     1         26

Gains/Lift Table: Avg response rate: 41.51 %, avg score: 41.31 %
group    cumulative_data_fraction    lower_threshold    lift     cumulative_lift    response_rate    score        cumulative_response_rate    cumulative_score    capture_rate    cumulative_capture_rate    gain     cumulative_gain    kolmogorov_smirnov
-------  --------------------------  -----------------  -------  -----------------  ---------------  -----------  --------------------------  ------------------  --------------  -------------------------  -------  -----------------  --------------------
1        0.0188679                   0.999588           2.40909  2.40909            1                0.99968      1                           0.99968             0.0454545       0.0454545                  140.909  140.909            0.0454545
2        0.0377358                   0.999448           2.40909  2.40909            1                0.999502     1                           0.999591            0.0454545       0.0909091                  140.909  140.909            0.0909091
3        0.0377358                   0.998734           0        2.40909            0                0            1                           0.999591            0               0.0909091                  -100     140.909            0.0909091
4        0.0566038                   0.997982           2.40909  2.40909            1                0.99813      1                           0.999104            0.0454545       0.136364                   140.909  140.909            0.136364
5        0.0566038                   0.997018           0        2.40909            0                0            1                           0.999104            0               0.136364                   -100     140.909            0.136364
6        0.113208                    0.994527           2.40909  2.40909            1                0.99567      1                           0.997387            0.136364        0.272727                   140.909  140.909            0.272727
7        0.150943                    0.993822           2.40909  2.40909            1                0.993991     1                           0.996538            0.0909091       0.363636                   140.909  140.909            0.363636
8        0.207547                    0.988339           2.40909  2.40909            1                0.993195     1                           0.995626            0.136364        0.5                        140.909  140.909            0.5
9        0.301887                    0.780779           2.40909  2.40909            1                0.959465     1                           0.984326            0.227273        0.727273                   140.909  140.909            0.727273
10       0.396226                    0.564416           1.44545  2.17965            0.6              0.635113     0.904762                    0.90118             0.136364        0.863636                   44.5455  117.965            0.79912
11       0.509434                    0.181206           1.20455  1.96296            0.5              0.410972     0.814815                    0.792245            0.136364        1                          20.4545  96.2963            0.83871
12       0.603774                    0.03505            0        1.65625            0                0.0645584    0.6875                      0.678544            0               1                          -100     65.625             0.677419
13       0.698113                    0.0184176          0        1.43243            0                0.0222848    0.594595                    0.58986             0               1                          -100     43.2432            0.516129
14       0.792453                    0.00521657         0        1.2619             0                0.0123515    0.52381                     0.521109            0               1                          -100     26.1905            0.354839
15       0.886792                    0.000122065        0        1.12766            0                0.00197785   0.468085                    0.465882            0               1                          -100     12.766             0.193548
16       1                           2.78953e-09        0        1                  0                2.46463e-05  0.415094                    0.413144            0               1                          -100     0                  0
[INFO]  getting best model finished!, time elapsed: 1310.4281556606293 seconds