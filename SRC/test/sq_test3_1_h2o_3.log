D:\Workplace-Pycharm\.venv\Scripts\python.exe D:\Workplace-Pycharm\QuantitativeTransaction\SRC\sq\test\sq_test3_1.py
2024-08-30 22:31:37.665169: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-08-30 22:31:39.412789: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
----------------------------------------
python sdk version: 3.0.168
c sdk version: 3.7.4
----------------------------------------
[INFO]  Start...
[INFO]  ManualTrainer train...
Checking whether there is an H2O instance running at http://localhost:54321..... not found.
Attempting to start a local H2O server...
; OpenJDK 64-Bit Server VM 18.9 (build 11.0.2+9, mixed mode)
  Starting server from D:\Workplace-Pycharm\.venv\Lib\site-packages\h2o\backend\bin\h2o.jar
  Ice root: C:\Users\Andy\AppData\Local\Temp\tmpur3vp24j
  JVM stdout: C:\Users\Andy\AppData\Local\Temp\tmpur3vp24j\h2o_Andy_started_from_python.out
  JVM stderr: C:\Users\Andy\AppData\Local\Temp\tmpur3vp24j\h2o_Andy_started_from_python.err
  Server is running at http://127.0.0.1:54321
Connecting to H2O server at http://127.0.0.1:54321 ... successful.
--------------------------  -----------------------------
H2O_cluster_uptime:         03 secs
H2O_cluster_timezone:       Asia/Shanghai
H2O_data_parsing_timezone:  UTC
H2O_cluster_version:        3.46.0.4
H2O_cluster_version_age:    1 month and 21 days
H2O_cluster_name:           H2O_from_python_Andy_o9xw2v
H2O_cluster_total_nodes:    1
H2O_cluster_free_memory:    3.844 Gb
H2O_cluster_total_cores:    0
H2O_cluster_allowed_cores:  0
H2O_cluster_status:         locked, healthy
H2O_connection_url:         http://127.0.0.1:54321
H2O_connection_proxy:       {"http": null, "https": null}
H2O_internal_security:      False
Python_version:             3.12.3 final
--------------------------  -----------------------------
Parse progress: |████████████████████████████████████████████████████████████████| (done) 100%
response column levels:  [['0', '1']]
train shape: (3089, 24)
test shape: (749, 24)
AutoML progress: |
22:32:16.675: AutoML: XGBoost is not available; skipping it.

███████████████████████████████████████████████████████████████| (done) 100%
********************
leaderboard:  model_id                                                      auc    logloss     aucpr    mean_per_class_error      rmse        mse
StackedEnsemble_AllModels_1_AutoML_1_20240830_223216     0.968709   0.225608  0.968094                0.105895  0.266913  0.0712427
StackedEnsemble_BestOfFamily_1_AutoML_1_20240830_223216  0.968318   0.227192  0.967766                0.107747  0.267854  0.0717458
GBM_grid_1_AutoML_1_20240830_223216_model_1              0.964106   0.24316   0.963767                0.11658   0.276844  0.0766426
DRF_1_AutoML_1_20240830_223216                           0.963447   0.282068  0.961578                0.117327  0.288311  0.0831233
XRT_1_AutoML_1_20240830_223216                           0.962798   0.292025  0.961288                0.116875  0.292588  0.0856078
GBM_4_AutoML_1_20240830_223216                           0.961784   0.254079  0.959588                0.112267  0.281012  0.0789675
GBM_grid_1_AutoML_1_20240830_223216_model_5              0.960311   0.257575  0.95768                 0.117559  0.283784  0.0805331
GBM_3_AutoML_1_20240830_223216                           0.954056   0.280036  0.951223                0.121734  0.293385  0.0860746
GBM_5_AutoML_1_20240830_223216                           0.951852   0.290655  0.947064                0.117437  0.29448   0.0867187
GBM_grid_1_AutoML_1_20240830_223216_model_4              0.949569   0.294307  0.946308                0.124981  0.29908   0.0894486
[22 rows x 7 columns]

********************
leaderboard.head:  model_id                                                      auc    logloss     aucpr    mean_per_class_error      rmse        mse
StackedEnsemble_AllModels_1_AutoML_1_20240830_223216     0.968709   0.225608  0.968094                0.105895  0.266913  0.0712427
StackedEnsemble_BestOfFamily_1_AutoML_1_20240830_223216  0.968318   0.227192  0.967766                0.107747  0.267854  0.0717458
GBM_grid_1_AutoML_1_20240830_223216_model_1              0.964106   0.24316   0.963767                0.11658   0.276844  0.0766426
DRF_1_AutoML_1_20240830_223216                           0.963447   0.282068  0.961578                0.117327  0.288311  0.0831233
XRT_1_AutoML_1_20240830_223216                           0.962798   0.292025  0.961288                0.116875  0.292588  0.0856078
[5 rows x 7 columns]

********************
Best Model: Model Details
=============
H2OStackedEnsembleEstimator : Stacked Ensemble
Model Key: StackedEnsemble_AllModels_1_AutoML_1_20240830_223216


Model Summary for Stacked Ensemble:
key                                        value
-----------------------------------------  ----------------
Stacking strategy                          cross_validation
Number of base models (used / total)       4/20
# GBM base models (used / total)           1/10
# DRF base models (used / total)           2/2
# GLM base models (used / total)           1/1
# DeepLearning base models (used / total)  0/7
Metalearner algorithm                      GLM
Metalearner fold assignment scheme         Random
Metalearner nfolds                         5
Metalearner fold_column
Custom metalearner hyperparameters         None

ModelMetricsBinomialGLM: stackedensemble
** Reported on train data. **

MSE: 0.006342026529724363
RMSE: 0.07963684153533691
LogLoss: 0.04298478709256318
AUC: 0.9999846715297813
AUCPR: 0.999983321683243
Gini: 0.9999693430595626
Null degrees of freedom: 3088
Residual degrees of freedom: 3084
Null deviance: 4276.706095461606
Residual deviance: 265.5600146578553
AIC: 275.5600146578553

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.4815949638232563
       0     1     Error    Rate
-----  ----  ----  -------  ------------
0      1606  4     0.0025   (4.0/1610.0)
1      2     1477  0.0014   (2.0/1479.0)
Total  1608  1481  0.0019   (6.0/3089.0)

Maximum Metrics: Maximum metrics at their respective thresholds
metric                       threshold    value     idx
---------------------------  -----------  --------  -----
max f1                       0.481595     0.997973  202
max f2                       0.385139     0.998919  208
max f0point5                 0.622024     0.998504  191
max accuracy                 0.505532     0.998058  200
max precision                0.999992     1         0
max recall                   0.385139     1         208
max specificity              0.999992     1         0
max absolute_mcc             0.481595     0.996109  202
max min_per_class_accuracy   0.505532     0.997972  200
max mean_per_class_accuracy  0.481595     0.998082  202
max tns                      0.999992     1610      0
max fns                      0.999992     1330      0
max fps                      2.58712e-05  1610      399
max tps                      0.385139     1479      208
max tnr                      0.999992     1         0
max fnr                      0.999992     0.899256  0
max fpr                      2.58712e-05  1         399
max tpr                      0.385139     1         208

Gains/Lift Table: Avg response rate: 47.88 %, avg score: 47.94 %
group    cumulative_data_fraction    lower_threshold    lift     cumulative_lift    response_rate    score        cumulative_response_rate    cumulative_score    capture_rate    cumulative_capture_rate    gain     cumulative_gain    kolmogorov_smirnov
-------  --------------------------  -----------------  -------  -----------------  ---------------  -----------  --------------------------  ------------------  --------------  -------------------------  -------  -----------------  --------------------
1        0.0100356                   1                  2.08857  2.08857            1                1            1                           1                   0.0209601       0.0209601                  108.857  108.857            0.0209601
2        0.0200712                   1                  2.08857  2.08857            1                1            1                           1                   0.0209601       0.0419202                  108.857  108.857            0.0419202
3        0.0301068                   1                  2.08857  2.08857            1                1            1                           1                   0.0209601       0.0628803                  108.857  108.857            0.0628803
4        0.0401424                   1                  2.08857  2.08857            1                1            1                           1                   0.0209601       0.0838404                  108.857  108.857            0.0838404
5        0.0501781                   0.999787           2.08857  2.08857            1                0.999927     1                           0.999985            0.0209601       0.104801                   108.857  108.857            0.104801
6        0.100032                    0.997843           2.08857  2.08857            1                0.998894     1                           0.999441            0.104124        0.208925                   108.857  108.857            0.208925
7        0.15021                     0.995507           2.08857  2.08857            1                0.996734     1                           0.998537            0.104801        0.313725                   108.857  108.857            0.313725
8        0.200065                    0.99189            2.08857  2.08857            1                0.993867     1                           0.997373            0.104124        0.41785                    108.857  108.857            0.41785
9        0.300097                    0.97806            2.08857  2.08857            1                0.98584      1                           0.993529            0.208925        0.626775                   108.857  108.857            0.626775
10       0.400129                    0.928681           2.08857  2.08857            1                0.958675     1                           0.984815            0.208925        0.8357                     108.857  108.857            0.8357
11       0.500162                    0.200908           1.64247  1.99935            0.786408         0.71777      0.957282                    0.931406            0.1643          1                          64.247   99.9353            0.959006
12       0.599871                    0.0442422          0        1.66703            0                0.0963659    0.798165                    0.792608            0               1                          -100     66.7026            0.767702
13       0.699903                    0.0149013          0        1.42877            0                0.0258444    0.684089                    0.68302             0               1                          -100     42.877             0.575776
14       0.799935                    0.00597593         0        1.2501             0                0.0100621    0.598543                    0.598866            0               1                          -100     25.0101            0.383851
15       0.899968                    0.00126946         0        1.11115            0                0.00342445   0.532014                    0.532682            0               1                          -100     11.1151            0.191925
16       1                           1.38738e-13        0        1                  0                0.000282491  0.478796                    0.479425            0               1                          -100     0                  0

ModelMetricsBinomialGLM: stackedensemble
** Reported on cross-validation data. **

MSE: 0.07124271418474495
RMSE: 0.2669133083694872
LogLoss: 0.2256081535826598
AUC: 0.9687091328285437
AUCPR: 0.9680944182460105
Gini: 0.9374182656570873
Null degrees of freedom: 3088
Residual degrees of freedom: 3083
Null deviance: 4277.116881909205
Residual deviance: 1393.8071728336722
AIC: 1405.8071728336722

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.42056978970374576
       0     1     Error    Rate
-----  ----  ----  -------  --------------
0      1404  206   0.128    (206.0/1610.0)
1      124   1355  0.0838   (124.0/1479.0)
Total  1528  1561  0.1068   (330.0/3089.0)

Maximum Metrics: Maximum metrics at their respective thresholds
metric                       threshold    value     idx
---------------------------  -----------  --------  -----
max f1                       0.42057      0.891447  221
max f2                       0.14199      0.936653  307
max f0point5                 0.831908     0.91922   99
max accuracy                 0.567101     0.894464  176
max precision                0.999953     1         0
max recall                   0.00306277   1         394
max specificity              0.999953     1         0
max absolute_mcc             0.567101     0.789069  176
max min_per_class_accuracy   0.486737     0.886335  202
max mean_per_class_accuracy  0.42057      0.894105  221
max tns                      0.999953     1610      0
max fns                      0.999953     1370      0
max fps                      3.62655e-05  1610      399
max tps                      0.00306277   1479      394
max tnr                      0.999953     1         0
max fnr                      0.999953     0.926302  0
max fpr                      3.62655e-05  1         399
max tpr                      0.00306277   1         394

Gains/Lift Table: Avg response rate: 47.88 %, avg score: 47.90 %
group    cumulative_data_fraction    lower_threshold    lift        cumulative_lift    response_rate    score       cumulative_response_rate    cumulative_score    capture_rate    cumulative_capture_rate    gain      cumulative_gain    kolmogorov_smirnov
-------  --------------------------  -----------------  ----------  -----------------  ---------------  ----------  --------------------------  ------------------  --------------  -------------------------  --------  -----------------  --------------------
1        0.0116543                   1                  2.08857     2.08857            1                1           1                           1                   0.0243408       0.0243408                  108.857   108.857            0.0243408
2        0.0213661                   1                  2.08857     2.08857            1                1           1                           1                   0.020284        0.0446247                  108.857   108.857            0.0446247
3        0.0301068                   0.999914           2.08857     2.08857            1                0.999998    1                           0.999999            0.0182556       0.0628803                  108.857   108.857            0.0628803
4        0.0401424                   0.999087           2.08857     2.08857            1                0.999539    1                           0.999884            0.0209601       0.0838404                  108.857   108.857            0.0838404
5        0.0501781                   0.998346           2.08857     2.08857            1                0.998704    1                           0.999648            0.0209601       0.104801                   108.857   108.857            0.104801
6        0.100032                    0.994267           2.07501     2.08181            0.993506         0.996402    0.996764                    0.998031            0.103448        0.208249                   107.501   108.181            0.207628
7        0.15021                     0.988293           2.08857     2.08407            1                0.991458    0.997845                    0.995835            0.104801        0.313049                   108.857   108.407            0.312428
8        0.200065                    0.97986            2.08857     2.08519            1                0.984349    0.998382                    0.992973            0.104124        0.417174                   108.857   108.519            0.416553
9        0.300097                    0.936567           2.0345      2.0683             0.97411          0.962715    0.990291                    0.982887            0.203516        0.62069                    103.45    106.83             0.6151
10       0.400129                    0.752313           1.71006     1.97874            0.81877          0.867841    0.947411                    0.954125            0.171062        0.791751                   71.0062   97.8737            0.751379
11       0.500162                    0.433037           1.17609     1.81821            0.563107         0.584805    0.87055                     0.880261            0.117647        0.909398                   17.609    81.8208            0.785175
12       0.599871                    0.126186           0.725576    1.63659            0.347403         0.279437    0.783594                    0.780394            0.0723462       0.981744                   -27.4424  63.6594            0.732676
13       0.699903                    0.0413206          0.128424    1.42104            0.0614887        0.0748443   0.680389                    0.679555            0.0128465       0.994591                   -87.1576  42.1041            0.565398
14       0.799935                    0.0140996          0.0405548   1.24841            0.0194175        0.024598    0.597734                    0.597652            0.0040568       0.998648                   -95.9445  24.8411            0.381256
15       0.899968                    0.00360837         0.00675914  1.1104             0.00323625       0.00806443  0.531655                    0.532119            0.000676133     0.999324                   -99.3241  11.04              0.190628
16       1                           0                  0.00675914  1                  0.00323625       0.00107205  0.478796                    0.478997            0.000676133     1                          -99.3241  0                  0

Cross-Validation Metrics Summary:
                      mean        sd            cv_1_valid    cv_2_valid    cv_3_valid    cv_4_valid    cv_5_valid
--------------------  ----------  ------------  ------------  ------------  ------------  ------------  ------------
accuracy              0.89914566  0.013191279   0.89533013    0.8962264     0.8863636     0.8962723     0.9215359
aic                   288.88666   27.047812     303.42715     299.66806     308.86365     290.46115     242.01329
auc                   0.96879923  0.0050338237  0.9659916     0.9672935     0.9647634     0.96849793    0.9774496
err                   0.10085433  0.013191279   0.104669884   0.10377359    0.11363637    0.10372771    0.078464106
err_count             62.4        8.905055      65.0          66.0          70.0          64.0          47.0
f0point5              0.8873051   0.022841372   0.87261146    0.8637972     0.89298624    0.884106      0.92302454
f1                    0.8963608   0.015895732   0.8939641     0.898773      0.8758865     0.8929766     0.92020375
f2                    0.90638906  0.029001128   0.916388      0.93670076    0.85942936    0.902027      0.9174001
lift_top_group        2.0886953   0.03771009    2.1122448     2.0921052     2.1168385     2.0986395     2.0236487
loglikelihood         0.0         0.0           0.0           0.0           0.0           0.0           0.0
---                   ---         ---           ---           ---           ---           ---           ---
mean_per_class_error  0.1002146   0.013444337   0.10282095    0.100923434   0.115601376   0.10319391    0.07853336
mse                   0.07094099  0.0071286615  0.07353223    0.07067341    0.0785289     0.07268552    0.05928486
null_deviance         855.4234    17.613983     859.2466      880.45276     852.2372      854.0004      831.1799
pr_auc                0.96814054  0.00582909    0.9623659     0.96808994    0.96513456    0.9673343     0.9777779
precision             0.88177085  0.033574514   0.85893416    0.84195405    0.9047619     0.87828946    0.92491466
r2                    0.7156325   0.028866818   0.70503813    0.71675736    0.68492454    0.70861423    0.7628282
recall                0.9136579   0.042106673   0.9319728     0.9638158     0.84879726    0.90816325    0.9155405
residual_deviance     278.08667   26.424736     291.42715     289.66806     296.86365     280.46115     232.01329
rmse                  0.26606607  0.013685027   0.27116826    0.26584473    0.28023008    0.2696025     0.24348482
specificity           0.88591284  0.039039426   0.86238533    0.83433735    0.92          0.88544893    0.9273927
[24 rows x 8 columns]

stackedensemble prediction progress: |███████████████████████████████████████████| (done) 100%
********************
predictions.head:    predict           p0           p1
        0  1            5.59702e-12
        1  0.477844     0.522156
        1  1.60106e-07  1
        1  0.035925     0.964075
        1  0.150801     0.849199
        1  0.298276     0.701724
        0  0.883916     0.116084
        0  0.949196     0.0508042
        1  0.3303       0.6697
        1  0.00796731   0.992033
[10 rows x 3 columns]

********************
metrics: ModelMetricsBinomialGLM: stackedensemble
** Reported on test data. **

MSE: 0.0754637931598364
RMSE: 0.2747067402883235
LogLoss: 0.2354050573966801
AUC: 0.9657181803908135
AUCPR: 0.9648206821678322
Gini: 0.931436360781627
Null degrees of freedom: 748
Residual degrees of freedom: 744
Null deviance: 1037.7307905046014
Residual deviance: 352.6367759802268
AIC: 362.6367759802268

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.3706583928152549
       0    1    Error    Rate
-----  ---  ---  -------  ------------
0      326  60   0.1554   (60.0/386.0)
1      25   338  0.0689   (25.0/363.0)
Total  351  398  0.1135   (85.0/749.0)

Maximum Metrics: Maximum metrics at their respective thresholds
metric                       threshold    value     idx
---------------------------  -----------  --------  -----
max f1                       0.370658     0.888305  235
max f2                       0.132642     0.938808  289
max f0point5                 0.758298     0.92323   137
max accuracy                 0.546349     0.890521  191
max precision                1            1         0
max recall                   0.0406886    1         334
max specificity              1            1         0
max absolute_mcc             0.546349     0.781263  191
max min_per_class_accuracy   0.485441     0.884298  207
max mean_per_class_accuracy  0.542827     0.889925  194
max tns                      1            386       0
max fns                      1            345       0
max fps                      1.56478e-05  386       399
max tps                      0.0406886    363       334
max tnr                      1            1         0
max fnr                      1            0.950413  0
max fpr                      1.56478e-05  1         399
max tpr                      0.0406886    1         334

Gains/Lift Table: Avg response rate: 48.46 %, avg score: 47.61 %
group    cumulative_data_fraction    lower_threshold    lift       cumulative_lift    response_rate    score        cumulative_response_rate    cumulative_score    capture_rate    cumulative_capture_rate    gain      cumulative_gain    kolmogorov_smirnov
-------  --------------------------  -----------------  ---------  -----------------  ---------------  -----------  --------------------------  ------------------  --------------  -------------------------  --------  -----------------  --------------------
1        0.0106809                   1                  2.06336    2.06336            1                1            1                           1                   0.0220386       0.0220386                  106.336   106.336            0.0220386
2        0.0200267                   1                  2.06336    2.06336            1                1            1                           1                   0.0192837       0.0413223                  106.336   106.336            0.0413223
3        0.0307076                   0.999453           2.06336    2.06336            1                0.9998       1                           0.99993             0.0220386       0.0633609                  106.336   106.336            0.0633609
4        0.0400534                   0.998723           2.06336    2.06336            1                0.99917      1                           0.999753            0.0192837       0.0826446                  106.336   106.336            0.0826446
5        0.0507343                   0.997857           2.06336    2.06336            1                0.998285     1                           0.999444            0.0220386       0.104683                   106.336   106.336            0.104683
6        0.100134                    0.992623           2.06336    2.06336            1                0.995551     1                           0.997524            0.101928        0.206612                   106.336   106.336            0.206612
7        0.150868                    0.985365           2.06336    2.06336            1                0.989578     1                           0.994852            0.104683        0.311295                   106.336   106.336            0.311295
8        0.200267                    0.974698           2.00759    2.04961            0.972973         0.980167     0.993333                    0.991229            0.0991736       0.410468                   100.759   104.961            0.407878
9        0.300401                    0.921505           2.00834    2.03585            0.973333         0.951155     0.986667                    0.977871            0.201102        0.61157                    100.834   103.585            0.603798
10       0.400534                    0.701459           1.73322    1.96019            0.84             0.832571     0.95                        0.941546            0.173554        0.785124                   73.3223   96.0193            0.746264
11       0.500668                    0.443345           1.12797    1.79375            0.546667         0.571933     0.869333                    0.867624            0.112948        0.898072                   12.7971   79.3748            0.771129
12       0.599466                    0.162908           0.752848   1.6222             0.364865         0.301018     0.786192                    0.774241            0.0743802       0.972452                   -24.7152  62.2197            0.723747
13       0.699599                    0.0428911          0.247603   1.42545            0.12             0.0843426    0.69084                     0.675496            0.0247934       0.997245                   -75.2397  42.5452            0.577556
14       0.799733                    0.0144995          0.0275115  1.25042            0.0133333        0.0258059    0.60601                     0.594149            0.00275482      1                          -97.2489  25.0417            0.388601
15       0.899866                    0.00335017         0          1.11128            0                0.00820072   0.538576                    0.528947            0               1                          -100      11.1276            0.194301
16       1                           3.06392e-12        0          1                  0                0.000970011  0.484646                    0.476079            0               1                          -100      0                  0
[INFO]  getting best model finished!, time elapsed: 646.0393812656403 seconds